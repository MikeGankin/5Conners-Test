(self.webpackChunkgulp_builder=self.webpackChunkgulp_builder||[]).push([[900],{588:(e,t,n)=>{var r,c,o=!1;function s(){r=[],n.e(504).then(function(){c=n(504);for(var e=0,t=r.length;e<t;e++)r[e].success(c);o=!1,r=null}.bind(null,n)).catch((function(){for(var e=0,t=r.length;e<t;e++)r[e].error.apply(this,arguments);o=!0,r=null}))}e.exports=function(e,t){t=t||function(){},c?e(c):(o&&s(),r.push({success:e,error:t}))},s()},900:(e,t,n)=>{"use strict";n.r(t);var r=n(588);const c=new DocumentFragment,o=document.querySelector(".goods-list"),s="plus",u="minus",d=e=>e.toString().replace(/\B(?=(\d{3})+(?!\d))/g," "),l=()=>{const e=[...document.querySelectorAll("[data-card]")],t=document.querySelector(".total__plug");Array.isArray(e)&&e.length?t.classList.add("hidden"):t.classList.remove("hidden")};l();const a=e=>{const t=[...document.querySelectorAll(".counter__number")];let n=[];t.forEach((e=>{n.push(Number(e.textContent))})),((e,t)=>{const n=document.querySelector(".order__description"),r=document.querySelector(".chart__counter");void 0!==t&&(n.textContent=`${e} товара на сумму ${t} ₽`,r.textContent=e)})(n.reduce(((e,t)=>e+t),0),e)},i=()=>{let e=0,t=0,n=0;const r=[...document.querySelectorAll("[data-card]")],c=document.querySelector(".goods__value"),o=document.querySelector(".final-price__value"),s=document.querySelector(".discount"),u=document.querySelector(".promo"),l=document.querySelector(".code");if(r.forEach((r=>{let c=r.querySelector("[data-base-price]").getAttribute("data-base-price"),o=r.querySelector(".counter__number").textContent,s=r.querySelector(".new-price__base"),u=r.querySelector(".new-price__discount");if(e+=Number(c)*Number(o),t=Number(c)*Number(o),s.textContent=`${d(t)} ₽`,r.hasAttribute("data-didcount-price")){let e=r.querySelector("[data-didcount-price]").getAttribute("data-didcount-price");n=Number(e)*Number(o),u.textContent=`${d(n)} ₽`}})),c.textContent=`${d(e)} ₽`,r&&e>=9e3){const t=e-9e3+200;o.textContent=`${d(t)} ₽`}else{const t=e+200;o.textContent=`${d(t)} ₽`,s.classList.add("hidden"),u.classList.add("hidden"),l.classList.add("hidden")}let i=d(e);a(i)};i();const b=(e,t)=>{let n=e.querySelector(".counter__number"),r=e.querySelector(".increase"),c=e.querySelector(".decrease");switch(t){case u:Number(n.textContent)>1&&(n.textContent=--n.textContent),Number(n.textContent)<3&&r.removeAttribute("disabled"),1===Number(n.textContent)&&c.setAttribute("disabled",!0),i(),a();break;case s:Number(n.textContent)<3&&(n.textContent=++n.textContent),3===Number(n.textContent)&&r.setAttribute("disabled",!0),Number(n.textContent)>1&&c.removeAttribute("disabled"),i(),a()}};document.querySelectorAll("[data-card]").forEach((e=>{const t=e.querySelector(".counter__number"),n=e.querySelector(".decrease");1===Number(t.textContent)?n.setAttribute("disabled",!0):n.removeAttribute("disabled")})),o.addEventListener("click",(e=>{let t=e.target;if(t.classList.contains("decrease")){const e=t.closest("[data-card]");(0,r.debounce)(b(e,u),100)}if(t.classList.contains("increase")){const e=t.closest("[data-card]");(0,r.debounce)(b(e,s),100)}t.classList.contains("card__close")&&(e=>{const t=e.closest(".card"),n=t.querySelector(".card__content").cloneNode(!0),r=t.querySelector(".card__title").textContent;c.appendChild(n),t.querySelector(".card__content").remove(),t.classList.add("delete-dialog"),t.removeAttribute("data-card");const o=`\n    <div class="delete-dialog__content">\n      <p class="delete-dialog__text">\n        Товар <span>${r}</span> был удален из корзины.\n      </p>\n      <button class="reset-btn delete-dialog__repair" type="button">Восстановить</button>\n      <button class="reset-btn close-btn delete-dialog__close" type="button">\n        <svg>\n          <use xlink:href="img/sprite.svg#close"></use>\n        </svg>\n      </button>\n    </div>\n  `;t.insertAdjacentHTML("afterbegin",o),a(),i(),l()})(t)}))}}]);